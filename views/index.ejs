<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>yuki-bbs</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
<div class="main-layout">
  <h1>❄️ yuki-bbs スレッド一覧 ❄️</h1>

  <form action="/" method="GET" class="search-box">
    <input type="text" name="q" placeholder="キーワードで検索" value="<%= keyword %>">
    <button type="submit">検索</button>
  </form>

  <form action="/thread" method="POST" class="new-thread">
    <input type="text" name="title" placeholder="新しいスレッドタイトル" required>
    <button type="submit">スレッド作成</button>
  </form>

  <div class="thread-list">
    <% threads.forEach(t => { %>
      <div class="thread-item">
        <a href="/thread/<%= t.id %>"><%= t.title %></a>
        <span>(<%= t.count %> 件)</span>
      </div>
    <% }) %>
  </div>

<div class="game-box">
  <h2>⚡ Reflex Game</h2>
  <div id="game-status">準備中...</div>
  <button id="start-btn">スタート</button>
  <div id="result"></div>
</div>
<script>
  let waiting = false;
  let startTime;

  document.getElementById("start-btn").onclick = function () {
    document.getElementById("result").textContent = "";
    document.getElementById("game-status").textContent = "光ったら押して！";
    waiting = true;
    this.disabled = true;
    setTimeout(() => {
      document.getElementById("game-status").textContent = "今だ！";
      startTime = Date.now();
      waiting = false;
      this.textContent = "押す！";
      this.disabled = false;
    }, 1000 + Math.random() * 2000);
  };

  document.getElementById("start-btn").addEventListener("click", () => {
    if (!waiting && startTime) {
      const reaction = Date.now() - startTime;
      document.getElementById("result").textContent = `反応速度: ${reaction} ミリ秒`;
      document.getElementById("start-btn").textContent = "スタート";
      document.getElementById("start-btn").disabled = false;
      startTime = null;
    }
  });
</script>

</div>
</body>
</html>
