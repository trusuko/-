<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ã¿ã‚“ãªã®æ²ç¤ºæ¿</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <h1>ğŸŒ¸ ã¿ã‚“ãªã®æ²ç¤ºæ¿ ğŸŒ¸</h1>
  <form action="/comment" method="POST" enctype="multipart/form-data">
    <input type="text" name="name" placeholder="åå‰" required>
    <textarea name="content" placeholder="ã‚³ãƒ¡ãƒ³ãƒˆå†…å®¹" required></textarea>
    <input type="file" name="image">
    <input type="hidden" name="parentId" id="parentId">
    <button type="submit">æŠ•ç¨¿</button>
  </form>

  <div class="comments">
    <% function renderComments(parentId) { %>
      <% comments.filter(c => c.parentId === parentId).forEach(c => { %>
        <div class="comment">
          <strong><%= c.name %></strong>ï¼ˆ<%= new Date(c.time).toLocaleString('ja-JP') %>ï¼‰<br>
          <%= c.content %><br>
          <% if (c.image) { %>
            <img src="<%= c.image %>" width="150"><br>
          <% } %>
          <button onclick="reply('<%= c.id %>')">è¿”ä¿¡</button>
          <div class="replies">
            <% renderComments(c.id); %>
          </div>
        </div>
      <% }) %>
    <% } %>
    <% renderComments(null); %>
  </div>

  <script>
    function reply(id) {
      document.getElementById('parentId').value = id;
      window.scrollTo(0, 0);
    }
  </script>
</body>
</html>
